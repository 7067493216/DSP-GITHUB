<mat-card class="p-4 shadow-sm border border-gray-300 rounded-lg bg-white">



<mat-toolbar color="primary" class="shadow-md rounded-md px-4 py-3">
  <!-- Full Width Container -->
  <div style="width: 100%; display: flex; justify-content: space-between; align-items: center;">
    
    <!-- Left: Title with Icon -->
    <div style="display: flex; align-items: center; gap: 8px; color: white; font-size: 1.1rem; font-weight: 600;">
      <mat-icon>attach_money</mat-icon>
      <span>Refund MIS List</span>
    </div>

    <!-- Right: Download Button -->
    <button mat-raised-button color="accent"
      (click)="exporter.exportTable('xlsx', { fileName: 'Refund-ApplicationList', sheet: 'sheet_name' })">
      <mat-icon class="mr-2">file_download</mat-icon>
      Download Excel
    </button>

  </div>
</mat-toolbar>



   


    <div class="mat-elevation-z8 table-container">
        <table mat-table [dataSource]="dataSource" matTableExporter #exporter="matTableExporter" matSort
            class="table userlist_tables">

            <!-- ACCOUNT HOLDER -->
            <ng-container matColumnDef="accountHolder">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Account Holder Name</th>
                <td mat-cell *matCellDef="let row">{{ row.ACCOUNT_HOLDER_NAME }}</td>
            </ng-container>

            <!-- BANK -->
            <ng-container matColumnDef="bank">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Bank Name</th>
                <td mat-cell *matCellDef="let row">{{ row.BANK_NAME }}</td>
            </ng-container>

            <!-- IFSC -->
            <ng-container matColumnDef="ifsc">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>IFSC Code</th>
                <td mat-cell *matCellDef="let row">{{ row.IFSC_CODE }}</td>
            </ng-container>

            <!-- ACCOUNT NO -->
            <ng-container matColumnDef="accountNo">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Bank Account No</th>
                <td mat-cell *matCellDef="let row">{{ row.ACCOUNT_NO }}</td>
            </ng-container>

            <!-- PAN -->
            <ng-container matColumnDef="pan">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>PAN Number</th>
                <td mat-cell *matCellDef="let row">{{ row.PAN_NO }}</td>
            </ng-container>

            <!-- ADDRESS -->
            <ng-container matColumnDef="addressProof">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Address</th>
                <td mat-cell *matCellDef="let row">{{ row.ADDRESS_PROOF_NO || '—' }}</td>
            </ng-container>

            <!-- REFUND AMOUNT -->
            <ng-container matColumnDef="refundAmount">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Refund ₹</th>
                <td mat-cell *matCellDef="let row">{{ row.REFUND_AMOUNT | number:'1.2-2' }}</td>
            </ng-container>

            <!-- REFUND TYPE -->
            <ng-container matColumnDef="refundType">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Refund Type</th>
                <td mat-cell *matCellDef="let row">{{ row.REFUND_TYPE }}</td>
            </ng-container>

            <!-- VOUCHER -->
            <ng-container matColumnDef="voucherNo">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Voucher</th>
                <td mat-cell *matCellDef="let row">{{ row.REFUND_VOUCHER_NO }}</td>
            </ng-container>

            <!-- CONSUMER NO -->
            <ng-container matColumnDef="consumerAppNo">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Consumer Application Number</th>
                <td mat-cell *matCellDef="let row">{{ row.CONSUMER_APPLICATION_NO }}</td>
            </ng-container>

            <!-- DC Name -->
            <ng-container matColumnDef="dcName">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>DC</th>
                <td mat-cell *matCellDef="let row">{{ row.DC_NAME }}</td>
            </ng-container>

            <!-- Sub Division -->
            <ng-container matColumnDef="subDivision">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Subdivision</th>
                <td mat-cell *matCellDef="let row">{{ row.SUB_DIVISION }}</td>
            </ng-container>

            <!-- Division -->
            <ng-container matColumnDef="division">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Division</th>
                <td mat-cell *matCellDef="let row">{{ row.DIVISION }}</td>
            </ng-container>

            <!-- Circle -->
            <ng-container matColumnDef="circle">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Circle</th>
                <td mat-cell *matCellDef="let row">{{ row.CIRCLE }}</td>
            </ng-container>

            <!-- Region -->
            <ng-container matColumnDef="region">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Region</th>
                <td mat-cell *matCellDef="let row">{{ row.REGION }}</td>
            </ng-container>

            <!-- DISCOM -->
            <ng-container matColumnDef="discom">
                <th mat-header-cell *matHeaderCellDef mat-sort-header>Details</th>
                <td mat-cell *matCellDef="let row">
                    <button type="button" class="btn btn-primary" (click)="onDetails(row)">
                        Details
                    </button>
                </td>
            </ng-container>

            <!-- (Same for all other columns as you listed earlier...) -->

            <tr mat-header-row *matHeaderRowDef="displayedColumns" class="bg-gray-100"></tr>
            <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
        </table>

        <mat-paginator [pageSizeOptions]="[ 10, 25,50,100,500,1000]" showFirstLastButtons></mat-paginator>