<!-- <consumer-application-view></consumer-application-view> -->

<div class="dsp-card-block dsp-cunsumerapplication">
    <div class="container-fluid">
        <div class="dsp-cunsumerapplicationinfo">
            <div class="card-header">
                <div style="display: flex;justify-content: space-around;">
                    <div>
                        <h2>
                            Consumer Application Management Dashboard
                        </h2>
                    </div>
                    <!-- <div align="right">
                        <form [formGroup]="roleForm">
                            <mat-form-field >
                                <mat-label>Switch Role</mat-label>
                                <mat-select formControlName="roleOfuser"  (selectionChange)="onRoleChange($event)" disableRipple >
                                    <mat-option *ngFor="let item of roleList" [value]="item">{{item.role}}</mat-option>
                                </mat-select>
                            </mat-form-field>
                        </form>
                    </div> -->
                </div>




            </div>
            <div class="card-body">
                <form [formGroup]="filterForm">
                    <div class="dsp-forminfo">
                        <div class="row">
                            <div class="col-sm-3">
                                <mat-form-field appearance="outline" class="form-group">
                                    <mat-select #myfilter [(value)]="filtertypeSelected" formControlName="filterType"
                                        (selectionChange)="getSearchType(myfilter.value)" disableRipple>
                                        <mat-option value="nothingSelected"> Select Filter Type</mat-option>
                                        <mat-option value="NatureOfWork">Nature Of Work</mat-option>
                                        <mat-option value="Applicant Name"> Applicant Name</mat-option>
                                        <mat-option value="ApplicationNumber"> ApplicationNumber</mat-option>
                                        <mat-option value="ApplicationStatus">ApplicationStatus</mat-option>
                                        <mat-option value="allType">All Type Of Application</mat-option>
                                    </mat-select>
                                    <mat-hint align="end">Please Select Filter Type here ^</mat-hint>
                                </mat-form-field>
                            </div>

                            <div class="col-sm-4" *ngIf="searchKey=='Applicant Name'">
                                <mat-form-field appearance="outline" class="form-group">
                                    <mat-label>Applicant Name ( आवेदक का नाम)</mat-label>
                                    <input matInput placeholder="" formControlName="filtervalueFirst">


                                </mat-form-field>
                                <mat-error *ngIf="filterForm.controls['filtervalueFirst']?.errors?.required">
                                    Please Enter Applicant Name
                                </mat-error>
                            </div>

                            <div class="col-sm-4" *ngIf="searchKey=='ApplicationNumber'">
                                <mat-form-field appearance="outline" class="form-group">
                                    <mat-label>Application Number (आवेदन क्रमांक)</mat-label>
                                    <input matInput placeholder="Enter Application Number" id=""
                                        formControlName="filterValueSecond">
                                    <mat-hint>Ex:DS110022022000/SV110022022000</mat-hint>

                                </mat-form-field>
                                <br>
                                <mat-error *ngIf="filterForm.controls['filterValueSecond']?.errors?.required">
                                    Please EnterApplication Number
                                </mat-error>
                            </div>

                            <!-- <div *ngIf="searchKey=='ApplicationStatus'">
                                <select class="form-select" aria-label="Default select example"
                                    formControlName="filtervaluelast">
                                    <option selected>Choose a ApplicationStatus</option>
                                    <option *ngFor="let e of ApplicationStatusList"
                                        value="{{e.applicationStatusId}}">{{e.applicationStatusName}}</option>
                                </select>
                                <mat-error *ngIf="filterForm.controls['filtervaluelast']?.errors?.required">
                                    Please Select ApplicationStatus
                                </mat-error>
                            </div> -->
                            <div class="col-sm-4" *ngIf="searchKey=='ApplicationStatus'">
                                <mat-form-field appearance="outline" class="form-group">
                                    <mat-label>Choose a ApplicationStatus</mat-label>
                                    <mat-select disableRipple formControlName="filtervaluelast">
                                        <!-- <mat-option selected>Choose a ApplicationStatus</mat-option> -->
                                        <mat-option *ngFor="let e of ApplicationStatusList"
                                            value="{{e.applicationStatusId}}">
                                            {{e.applicationStatusName}}</mat-option>
                                    </mat-select>
                                </mat-form-field>
                                <mat-error *ngIf="filterForm.controls['filtervaluelast']?.errors?.required">
                                    Please Select ApplicationStatus
                                </mat-error>
                            </div>

                            <div class="col-sm-4" *ngIf="searchKey=='NatureOfWork'">
                                <mat-form-field appearance="outline" class="form-group">
                                    <mat-label>Choose Nature Of Work</mat-label>
                                    <!-- {{ApplicationStatusList|json}} -->
                                    <mat-select disableRipple formControlName="filterValueFourth">
                                        <mat-option *ngFor="let e of NatureOfworkTypeList"
                                            value="{{e.natureOfWorkTypeId}}">
                                            {{e.natureOfWorkName}}</mat-option>

                                    </mat-select>

                                </mat-form-field>
                                <mat-error *ngIf="filterForm.controls['filterValueFourth']?.errors?.required">
                                    Please Select Nature Of Work
                                </mat-error>
                            </div>
                            <div class="col-sm-3">
                                <div class="form-group">
                                    <button type="submit" class="btn formButton btn-secondary"
                                        (click)="filter(0,10)">Search</button>
                                    <button mat-raised-button class="btn dspButton btn-danger mx-1"
                                        (click)="exporter.exportTable('xlsx', {fileName:'Consumer-ApplicationList', sheet: 'sheet_name'})"
                                        *ngIf="listData!== null">
                                        Download Excel
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                </form>

                <!-- <div align="right">
                    <label>Change Role</label>
                    <select>
                        <option *ngFor="let item of userRole" [value]="item.id">
                            {item.name}
                        </option>
                    </select>
                </div> -->



                <div class="table_consumerapplication">
                    <div class="table-responsive">
                        <mat-table [dataSource]="listData" matTableExporter #exporter="matTableExporter"
                            [hiddenColumns]="[20,21,22,23,24]" matSort style="max-height:610px !important;">
                            <!-- Position Column -->



                            <ng-container matColumnDef="position">
                                <mat-header-cell *matHeaderCellDef mat-sort-header class="mw-5"> No. <br>(
                                    क्रमांक)</mat-header-cell>
                                <mat-cell *matCellDef="let element; let i = index;">
                                    {{paginator.pageSize * paginator.pageIndex + i + 1}}
                                </mat-cell>
                            </ng-container>

                            <ng-container matColumnDef="consumerApplicationNo" class="mw-15">
                                <mat-header-cell *matHeaderCellDef mat-sort-header>Application No <br>(आवेदन क्रमांक)
                                </mat-header-cell>
                                <mat-cell *matCellDef="let element"> {{element.consumerApplicationNo}} </mat-cell>
                            </ng-container>

                            <!-- Scheme Type Column -->
                            <ng-container matColumnDef="schemeType">
                                <mat-header-cell *matHeaderCellDef mat-sort-header class="mw-10">Scheme Type <br> (योजना
                                    का प्रकार)
                                </mat-header-cell>
                                <mat-cell *matCellDef="let element">{{element.schemeType.schemeTypeName}} </mat-cell>
                            </ng-container>

                            <!-- Nature of work -->
                            <ng-container matColumnDef="natureOfWork">
                                <mat-header-cell *matHeaderCellDef mat-sort-header class="mw-10">Nature of
                                    Work-<br>(कार्य प्रकार)
                                </mat-header-cell>
                                <mat-cell *matCellDef="let element">{{element.natureOfWorkType.natureOfWorkName}}
                                </mat-cell>
                            </ng-container>

                            <!-- Consumer Name Column -->
                            <ng-container matColumnDef="consumerName">
                                <mat-header-cell *matHeaderCellDef mat-sort-header class="mw-15">Applicant Name <br>(
                                    आवेदक का नाम)
                                </mat-header-cell>
                                <mat-cell *matCellDef="let element"> {{element.consumerName}} </mat-cell>
                            </ng-container>



                            <ng-container matColumnDef="stage">
                                <mat-header-cell *matHeaderCellDef mat-sort-header class="mw-25">Application Pending On
                                    <br> (आवेदन
                                    लंबित स्तर पर)</mat-header-cell>
                                <mat-cell *matCellDef="let element">

                                    <b>
                                      
                                        {{ element.applicationStatus?.applicationStatusName }}

                                      
                                    </b>
                                </mat-cell>
                            </ng-container>

                            <ng-container matColumnDef="dcName">
                                <mat-header-cell class="mw-15" *matHeaderCellDef mat-sort-header>Distribution Center<br>
                                    (वितरण
                                    केंद्र)</mat-header-cell>
                                <mat-cell class="mw-15" *matCellDef="let element">{{element.distributionCenter.dcName}}
                                </mat-cell>
                            </ng-container>

                            <ng-container matColumnDef="loadRequest">
                                <mat-header-cell class="mw-15" *matHeaderCellDef mat-sort-header>Load<br>
                                    (भार)</mat-header-cell>
                                <mat-cell class="mw-15" *matCellDef="let element">{{element.loadRequested}}
                                    {{element.loadRequestedId?.loadRequestedName}} </mat-cell>
                            </ng-container>

                            <ng-container matColumnDef="erpWorkFlowNumber">
                                <mat-header-cell class="mw-15" *matHeaderCellDef mat-sort-header>ERP
                                    NUMBER<br>
                                    (प्राकलन संख्या)</mat-header-cell>
                                <mat-cell class="mw-15"
                                    *matCellDef="let element">{{element.erpWorkFlowNumber}}</mat-cell>
                            </ng-container>

                           

                            <ng-container matColumnDef="MobileNumber">
                                <mat-header-cell class="mw-15" *matHeaderCellDef mat-sort-header>Mobile
                                    Number<br>(मोबाइल नंबर)
                                </mat-header-cell>
                                <mat-cell class="mw-15" *matCellDef="let element">{{element.consumers?.consumerLoginId}}
                                </mat-cell>
                            </ng-container>


                            <ng-container matColumnDef="Address">
                                <mat-header-cell class="mw-15" *matHeaderCellDef mat-sort-header>Address<br>(पता)
                                </mat-header-cell>
                                <mat-cell class="mw-15" *matCellDef="let element">{{element.address}} </mat-cell>
                            </ng-container>

                            <!-- registrationPaymentDate -->
                            <ng-container matColumnDef="registrationPaymentDate">
                                <mat-header-cell class="mw-15" *matHeaderCellDef mat-sort-header>Registration Payment
                                    Date<br>(पंजीकरण भुगतान तिथि)
                                </mat-header-cell>
                                <mat-cell class="mw-15" *matCellDef="let element">
                                    <div *ngIf="element.listOfTransactionDate != null">
                                        {{element.listOfTransactionDate[0]?.REGISTRATION_DATE | date}}
                                    </div>
                                </mat-cell>
                            </ng-container>

                            <!-- demandPaymentDate -->
                            <ng-container matColumnDef="demandPaymentDate">
                                <mat-header-cell class="mw-15" *matHeaderCellDef mat-sort-header>Demand Payment
                                    Date<br>(मांग भुगतान
                                    तिथि)
                                </mat-header-cell>
                                <mat-cell class="mw-15" *matCellDef="let element">
                                    <div *ngIf="element.listOfTransactionDate != null">
                                        {{element.listOfTransactionDate[0]?.DEMAND_DATE | date}}
                                    </div>

                                </mat-cell>
                            </ng-container>

                            <!-- feedback -->
                            <ng-container matColumnDef="feedback">
                                <mat-header-cell class="mw-15" *matHeaderCellDef mat-sort-header>Consumer Feedback
                                </mat-header-cell>
                                <mat-cell class="mw-15" *matCellDef="let element">


                                </mat-cell>
                            </ng-container>


                            <!-- Status Column -->
                            <ng-container matColumnDef="status">
                                <mat-header-cell *matHeaderCellDef mat-sort-header class="mw-10">Status <br> (वर्तमान
                                    स्थिति)
                                </mat-header-cell>
                                <mat-cell *matCellDef="let element">

                                    <b>



                                        <span *ngIf="element?.applicationStatus?.applicationStatusId == 29"
                                            style="color:black; background-color: crimson; padding: 8%;font:bold;">
                                            Rejected
                                        </span>
                                        <span
                                            *ngIf="element?.applicationStatus?.applicationStatusId != 33 && element?.applicationStatus?.applicationStatusId != 29"
                                            style="color:black; background-color: orange; padding: 8%; font:bold;">
                                            Pending
                                        </span>
                                        <span *ngIf="element?.applicationStatus?.applicationStatusId == 33"
                                            style="color:white; background-color: green; padding: 8%;font:bold;">
                                            Completed
                                        </span>


                                    </b>
                                </mat-cell>
                            </ng-container>

                            <!-- Edit/View Column -->
                            <ng-container matColumnDef="edit">
                                <!-- <mat-header-cell *matHeaderCellDef [hidden]="!role.roleMatch(role.todo_module_edit)"> Edit/View -->
                                <mat-header-cell *matHeaderCellDef class="mw-20"> Edit/View <br> परिवर्तन/देखे
                                </mat-header-cell>
                                <mat-cell *matCellDef="let row">
                                    <div class="btn-actionifo">

                                        <!-- <button matTooltip="View Consumer Application" (click)="onView(row,row.consumerApplicationId)"
                                                mat-icon-button color="primary" class="m-1 btnaction_custome">
                                            
                                                <mat-icon> all_out </mat-icon>
                                            </button> -->

                                        <button matTooltip="View Consumer Application"
                                            (click)="onNewView(row,row.consumerApplicationId)" mat-icon-button
                                            color="primary" class="m-1 btnaction_custome">

                                            <mat-icon> all_out </mat-icon>
                                        </button>



                                        <!-- &&  canViewBackStageButtton(row.applicationStatus.applicationStatusId) -->
                                        <!-- <div *ngIf="row.previousStage == false  && row.isRejected != 1   && (
                                                 row.applicationStatus?.applicationStatusId == 9
                                                ||  row.applicationStatus?.applicationStatusId == 10 
                                                ||  row.applicationStatus?.applicationStatusId == 11
                                                ) ">
                                                
                                            <button matTooltip="send application to previous Stage" mat-icon-button
                                                color="warn" (click)="backToPreviousStage(row.consumerApplicationId)"
                                                class="m-1 btnaction_custome">
                                                <mat-icon>reply</mat-icon>
                                            </button>
                                        </div> -->

                                        <span *ngIf="userRolesData== 'JE_IT'">
                                            <button class="m-1 btnaction_custome"
                                                *ngIf="row.applicationStatus?.applicationStatusId <= 4 && row.isRejected != 1"
                                                matTooltip="Edit Consumer Application" mat-icon-button color="primary"
                                                (click)="onEdit(row.consumerApplicationId)">
                                                <mat-icon>launch</mat-icon>
                                            </button>
                                        </span>




                                        <!-- ******************************************************************** complaint ********************************* -->
                                         <br>
                                        <!-- <span>
                                            <button class=" btn-sm m-1" (click)="onComplain(row.consumerApplicationNo)"
                                                type="button" class="btn btn-secondary m-1 btnaction_custome">
                                                Complain
                                            </button>
                                        </span><br> -->

                                        <!-- ******************************************************************** complaint ***************************** -->


                                        <!-- *************************************************************************  REFUND PAYMENT ************************************************************ -->
                                        <!-- <span *ngIf="userRolesData=='DGM'">
                                            <button class=" btn-sm m-1" (click)="onRefundRequest(row)" type="button" *ngIf="row.applicationStatus?.applicationStatusId >12 && row.applicationStatus?.applicationStatusId!=39 && row.isRejected != 1"
                                                class="btn btn-primary m-1 btnaction_custome">
                                                Refund Request
                                            </button>
                                        </span> -->

                                        <!-- <span *ngIf="userRolesData=='DGM'">
                                            <button class=" btn-sm m-1" (click)="onRefundRequest(row)" type="button" 
                                                class="btn btn-primary m-1 btnaction_custome">
                                                Refund Request
                                            </button>
                                        </span> -->


                                        <!-- <span *ngIf="userRolesData=='DGM_(HTM)'">
                                            <button class=" btn-sm m-1" (click)="onRefundRequest(row)" type="button" *ngIf="row.applicationStatus?.applicationStatusId >12 && row.applicationStatus?.applicationStatusId!=39 && row.isRejected != 1"
                                                class="btn btn-primary m-1 btnaction_custome">
                                                Refund Request
                                            </button>
                                        </span> -->

                                        <!-- *************************************************************************  REFUND PAYMENT ************************************************************ -->


                                        <!-- *************************************************************************  REFUND PAYMENT Confirmation By Gm ************************************************************ -->
                                       <!-- <span *ngIf="userRolesData=='GM'">
                                        <button class=" btn-sm m-1" (click)="onRefundConfirmation(row)" type="button" *ngIf="row.applicationStatus?.applicationStatusId == 39 && row.isRejected != 1"
                                            class="btn btn-primary m-1 btnaction_custome">
                                            Refund Confirmation
                                        </button>
                                        </span> -->

                                        <!-- *************************************************************************  REFUND PAYMENT Confirmation By Gm ************************************************************ -->


                                        <!-- ******************************************* Dc Acceptance For Je && Ae and Manager(Htm) start ************************************************** -->
                                        <span *ngIf="userRolesData== 'JE_IT'">
                                            <button
                                                *ngIf="row.applicationStatus?.applicationStatusId == 6 && row.isRejected != 1"
                                                class="btn btn-sm btn-success m-1 btnaction_custome"
                                                (click)="applicationDcAcceptance(row.consumerApplicationId,row.previousStage,row)">
                                                Application DC Acceptance
                                            </button>
                                        </span>

                                        <!-- <span *ngIf="userRolesData=='JE_IT'">
                                            <button
                                                
                                                class="btn btn-sm btn-success m-1 btnaction_custome"
                                                (click)="applicationDcAcceptance(row.consumerApplicationId,row.previousStage,row)">
                                                Application DC Acceptance
                                            </button>
                                        </span> -->


                                        <span *ngIf="userRolesData=='AE_IT_(VIEW)'">
                                            <button
                                                *ngIf="row.applicationStatus?.applicationStatusId == 6 && row.isRejected != 1 "
                                                class="btn btn-sm btn-success m-1 btnaction_custome"
                                                (click)="applicationDcAcceptance(row.consumerApplicationId,row.previousStage,row)">
                                                Application DC Acceptance
                                            </button>
                                        </span>

                                        <span *ngIf="userRolesData=='Manager (HTM)'">
                                            <button
                                                *ngIf="row.applicationStatus?.applicationStatusId == 6 && row.isRejected != 1"
                                                class="btn btn-sm btn-success m-1 btnaction_custome"
                                                (click)="applicationDcAcceptance(row.consumerApplicationId,row.previousStage,row)">
                                                Application DC Acceptance
                                            </button>
                                        </span>

                                        <span *ngIf="userRolesData=='Manager (O&M)'">
                                            <button
                                                *ngIf="row.applicationStatus?.applicationStatusId == 6 && row.isRejected != 1"
                                                class="btn btn-sm btn-success m-1 btnaction_custome"
                                                (click)="applicationDcAcceptance(row.consumerApplicationId,row.previousStage,row)">
                                                Application DC Acceptance
                                            </button>
                                        </span>
                                        <!-- //'Manager (HTM)' -->
                                        <!-- <span *appHasRole="role.Manager_HTM">
                                            <button
                                                *ngIf="row.applicationStatus?.applicationStatusId == 6 && row.isRejected != 1"
                                                class="btn btn-sm btn-success m-1 btnaction_custome"
                                                (click)="applicationDcAcceptance(row.consumerApplicationId,row.previousStage,row)">
                                                Application DC Acceptance
                                            </button>
                                        </span> -->

                                        <!-- <span *ngIf="userRolesData=='DGM_(HTM)'">
                                            <button
                                                *ngIf="row.applicationStatus?.applicationStatusId == 6 && row.isRejected != 1"
                                                class="btn btn-sm btn-success m-1 btnaction_custome"
                                                (click)="applicationDcAcceptance(row.consumerApplicationId,row.previousStage,row)">
                                                Application DC Acceptance
                                            </button>
                                        </span> -->

                                        <!-- ******************************************* Dc Acceptance For Je && Ae and Manager(Htm) end ************************************************** -->


                                        <!-- ****************************  survey Break for je start******************** -->

                                        <span *ngIf="userRolesData== 'JE_IT'">
                                            <button
                                                *ngIf="row.applicationStatus?.applicationStatusId == 7 && row.isRejected != 1"
                                                class="btn btn-sm btn-success m-1 btnaction_custome"
                                                (click)="onJeSurveyBreak(row)">
                                                Survey
                                            </button>
                                        </span>

                                        <span *ngIf="userRolesData=='Manager (HTM)'">
                                            <button
                                                *ngIf="row.applicationStatus?.applicationStatusId == 7 && row.isRejected != 1 "
                                                class="btn btn-sm btn-success m-1 btnaction_custome"
                                                (click)="onJeSurveyBreak(row)">
                                                Survey
                                            </button>
                                        </span>

                                        <!-- <span *appHasRole="role.Manager_HTM">
                                            <button
                                                *ngIf="row.applicationStatus?.applicationStatusId == 7 && row.isRejected != 1 "
                                                class="btn btn-sm btn-success m-1 btnaction_custome"
                                                (click)="onJeSurveyBreak(row)">
                                                Survey
                                            </button>
                                        </span> -->

                                        <!-- ****************************  survey Break for je end ******************** -->


                                        <!-- *************************  Survey By Dgm(O&M) and Dgm(HTM) start ******************************* -->

                                        <span *ngIf="userRolesData=='DGM'">
                                            <button
                                                *ngIf="row.applicationStatus?.applicationStatusId == 9 && row.isRejected != 1 "
                                                class="btn btn-sm btn-primary m-1 btnaction_custome"
                                                (click)="applicationSurvey(row.consumerApplicationId,row.previousStage,row)">
                                                <!-- Application Survey -->
                                                Estimate And Demand Note Generation
                                            </button>
                                        </span>


                                        <!-- <span >
                                            <button
                                                *ngIf="row.applicationStatus?.applicationStatusId == 9 && row.isRejected != 1 "
                                                class="btn btn-sm btn-primary m-1 btnaction_custome"
                                                (click)="applicationSurvey(row.consumerApplicationId,row.previousStage,row)">
                                              
                                                Estimate And Demand Note Generation
                                            </button>
                                        </span> -->

                                        <span *ngIf="userRolesData=='DGM_(HTM)'">
                                            <button
                                                *ngIf="row.applicationStatus?.applicationStatusId == 9 && row.isRejected != 1 "
                                                class="btn btn-sm btn-primary m-1 btnaction_custome"
                                                (click)="applicationSurvey(row.consumerApplicationId,row.previousStage,row)">
                                                <!-- Application Survey -->
                                                Estimate And Demand Note Generation
                                            </button>
                                        </span>

                                        <!-- *************************  Survey By Dgm(O&M) and Dgm(HTM) end ******************************* -->



                                        <!-- ********************************************** connection paradaai by Je start ************************************************ -->

                                        <span *ngIf="userRolesData== 'JE_IT'">
                                            <button
                                                *ngIf="(row.natureOfWorkType?.natureOfWorkTypeId==2 || row.natureOfWorkType?.natureOfWorkTypeId==5) && row.applicationStatus?.applicationStatusId == 32 && row.isRejected != 1 "
                                                class="btn btn-sm btn-primary m-1 btnaction_custome"
                                                (click)="connectioPradaai(row)">
                                                connection praday
                                            </button>
                                        </span>

                                        <!-- <span *ngIf="userRolesData== 'JE_IT'">
                                            <button
                                                
                                                class="btn btn-sm btn-primary m-1 btnaction_custome"
                                                (click)="connectioPradaai(row)">
                                                connection praday
                                            </button>
                                        </span> -->



                                        <!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->

                                        <span *ngIf="userRolesData== 'JE_IT'">
                                            <button
                                                *ngIf="row.natureOfWorkType?.natureOfWorkTypeId==8 && row.applicationStatus?.applicationStatusId == 32"
                                                class="btn btn-sm btn-primary m-1 btnaction_custome"
                                                (click)="connectioPradaaiForNgb(row)">
                                                connection praday NGB
                                            </button>
                                        </span>

                                        <!-- <span >
                                            <button
                                                
                                                class="btn btn-sm btn-primary m-1 btnaction_custome"
                                                (click)="connectioPradaaiForNgb(row)">
                                                connection praday NGB
                                            </button>
                                        </span> -->


                                        <!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->




                                        <!-- <span *ngIf="userRolesData== 'JE_IT'">
                                            <button
                                                *ngIf="row.natureOfWorkType?.natureOfWorkTypeId==8 "
                                                class="btn btn-sm btn-primary m-1 btnaction_custome"
                                                (click)="connectioPradaaiForNgb(row)">
                                                connection praday NGB
                                            </button>
                                        </span> -->



                                        <!-- ********************************************** connection paradaai by Je end ************************************************ -->



                                        <!-- <span *ngIf="userRolesData=='Manager (HTM)'">
                                            <button
                                                *ngIf="row.applicationStatus?.applicationStatusId == 9 && row.isRejected != 1  && (userRolesData=='Manager (HTM)' )"
                                                class="btn btn-sm btn-primary m-1 btnaction_custome"
                                                (click)="applicationSurvey(row.consumerApplicationId,row.previousStage,row)">
                                                Application Survey
                                            </button>
                                        </span>

                                        <span *appHasRole="role.Manager_HTM">
                                            <button
                                                *ngIf="row.applicationStatus?.applicationStatusId == 9 && row.isRejected != 1  && (role.Manager_HTM)"
                                                class="btn btn-sm btn-primary m-1 btnaction_custome"
                                                (click)="applicationSurvey(row.consumerApplicationId,row.previousStage,row)">
                                                Application Survey
                                            </button>
                                        </span> -->



                                        <!-- <span *appHasRole="role.ae_it_view">
                                            <button
                                                *ngIf="row.applicationStatus?.applicationStatusId == 9 && row.isRejected != 1  && (role.ae_it_view )"
                                                class="btn btn-sm btn-primary m-1 btnaction_custome"
                                                (click)="applicationSurvey(row.consumerApplicationId,row.previousStage,row)">
                                                Application Survey
                                            </button>
                                        </span> -->


                                        <!-- ******************************************************************** Application Demaand start ***********************8 -->
                                        <span *ngIf="row.natureOfWorkType?.natureOfWorkTypeId!=8">
                                            <button
                                                *ngIf="row.applicationStatus?.applicationStatusId >12  && row.applicationStatus?.applicationStatusId!=24 && row.applicationStatus?.applicationStatusId!=36 && row.applicationStatus?.applicationStatusId!=38 && row.revisedErpNumber==null  && row.isRejected!= 1 "
                                                class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                (click)="applicationDemandGenerate(row.consumerApplicationId,row.previousStage,row.consumerApplicationNo,row.schemeType.schemeTypeId,row)">
                                                Application Demand
                                            </button>
                                        </span>

                                        <span *ngIf="row.natureOfWorkType?.natureOfWorkTypeId==8">
                                            <button
                                                *ngIf="row.applicationStatus?.applicationStatusId >12 && row.applicationStatus?.applicationStatusId!=24 && row.applicationStatus?.applicationStatusId!=36 && row.applicationStatus?.applicationStatusId!=38 && row.revisedErpNumber==null  && row.isRejected!= 1 "
                                                class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                (click)="applicationDemandGenerateForMkmy(row.consumerApplicationId,row.consumerApplicationNo,row?.schemeType?.schemeTypeId,row.natureOfWorkType?.natureOfWorkTypeId,row)">
                                                Application Demand
                                            </button>
                                        </span>

                                        <!-- ******************************************************************** Application Demaand end ***********************8 -->

                                        <!-- <span *ngIf="row.natureOfWorkType?.natureOfWorkTypeId==8">
                                                <button *ngIf="row.applicationStatus?.applicationStatusId >=12  && row.isRejected!= 1 "
                                                    class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                    (click)="applicationDemandGenerateForMkmy(row.consumerApplicationId,row.consumerApplicationNo,row?.schemeType?.schemeTypeId,row.natureOfWorkType?.natureOfWorkTypeId,row)">
                                                    Application Demand
                                                </button>
                                            </span> -->


                                        <!-- ********************************************** Revise estimate  by Dgm(O&M) start ******************************************* -->

                                        <span *ngIf="userRolesData=='DGM'">
                                            <button *ngIf=" row.applicationStatus?.applicationStatusId==24 "
                                                class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                (click)="onRevisePaymentGenerate(row)">
                                                Revise Estimate
                                            </button>
                                        </span>


                                        <!-- <span>
                                            <button *ngIf=" row.applicationStatus?.applicationStatusId==24 "
                                                class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                (click)="onRevisePaymentGenerate(row)">
                                                Revise Estimate
                                            </button>
                                        </span> -->

                                        <!-- ********************************************** Revise estimate  by Dgm(O&M) end ******************************************* -->


                                        <!-- ********************************** Revise Demaand start ********************************************************************** -->

                                        <!-- <span>
                                            <button *ngIf="row.revisedErpNumber!=null"
                                                class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                (click)="onRevisePaymentDemand(row)">
                                                Revise Demand
                                            </button>
                                        </span> -->


                                        <span>
                                            <button *ngIf="row.revisedErpNumber!=null"
                                                class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                (click)="onRevisePaymentDemand(row)">
                                                Revise Demand
                                            </button>
                                        </span>

                                        <!-- ********************************** Revise Demaand end ********************************************************************** -->





                                        <!-- <span *ngIf="userRolesData=='DGM_STC'">
                                            
                                                <button class=" btn-sm " *ngIf=" row.applicationStatus?.applicationStatusId==27"
                                                    matTooltip="Contractor"
                                                    (click)="onStcRemark(row)"
                                                    type="button" class="btn   btn-warning btnaction_custome">
                                                    STC-REMARK
                                                </button>
                                            </span> -->

                                        <!-- <span >
                                            
                                                <button class=" btn-sm " 
                                                    matTooltip="Contractor"
                                                    (click)="onStcRemark(row)"
                                                    type="button" class="btn   btn-warning btnaction_custome">
                                                    STC-REMARK
                                                </button>
                                            </span> -->


                                        <!-- ****************************************** Return Materials start **************************************************** -->

                                        <!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

                                            <span *ngIf="userRolesData=='DGM'">
                                               
                                                <button *ngIf="(row.natureOfWorkType?.natureOfWorkTypeId==1 || row.natureOfWorkType?.natureOfWorkTypeId==6) && row.applicationStatus?.applicationStatusId==23 && row.returnMaterialData==null"
                                                    class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                    (click)="returnMaterial(row)">
                                                    Return Material
                                                </button>
                                            </span>

                                            <span *ngIf="userRolesData=='DGM_(HTM)'">
                                              
                                                <button *ngIf="(row.natureOfWorkType?.natureOfWorkTypeId==1 || row.natureOfWorkType?.natureOfWorkTypeId==6) && row.applicationStatus?.applicationStatusId==23 && row.returnMaterialData==null"
                                                    class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                    (click)="returnMaterial(row)">
                                                    Return Material
                                                </button>
                                            </span>


                                            &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->

                                        <!-- <span >
                                               
                                                <button 
                                                    class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                    (click)="returnMaterial(row)">
                                                    Return Material
                                                </button>
                                            </span> -->

                                        <!-- ****************************************** Return Materials end **************************************************** -->


                                        <!-- ************************************************ Select Contractor By Dgm(O&M) start ************************************************** -->
                                        <span *ngIf="userRolesData=='DGM_STC'">
                                            <!--   &&  -->
                                            <button class=" btn-sm "
                                                *ngIf="row.natureOfWorkType?.natureOfWorkTypeId==8 &&  row?.schemeType?.schemeTypeId==2 && row.applicationStatus?.applicationStatusId==34"
                                                matTooltip="Contractor"
                                                (click)="onSelectContractor(row.consumerApplicationNo,row.consumerApplicationId)"
                                                type="button" class="btn   btn-warning btnaction_custome">
                                                select contractor
                                            </button>
                                        </span>

                                        <span *ngIf="userRolesData=='DGM_STC'">
                                            <!--   &&   *ngIf="consumerApplicationDetail?.schemeType?.schemeTypeId == 2   row?.schemeType?.schemeTypeId==2 && -->
                                            <button class=" btn-sm "
                                                *ngIf="row.natureOfWorkType?.natureOfWorkTypeId!=8 &&  row?.schemeType?.schemeTypeId==2 && row.applicationStatus?.applicationStatusId==34"
                                                matTooltip="Contractor"
                                                (click)="onSelectContractor(row.consumerApplicationNo,row.consumerApplicationId)"
                                                type="button" class="btn   btn-warning btnaction_custome">
                                                select contractor
                                            </button>
                                        </span>



                                        <span *ngIf="userRolesData=='GM'">
                                            <button class="btn-sm"
                                            *ngIf="row?.schemeType?.schemeTypeId==1 && (row.applicationStatus?.applicationStatusId==22 || row.applicationStatus?.applicationStatusId==23 || row.applicationStatus?.applicationStatusId==24 )"
                                                matTooltip="Contractor"
                                                (click)="onRequestForChangeContractor(row)"
                                                type="button" class="btn   btn-warning btnaction_custome">
                                                Change contractor
                                            </button>
                                        </span>


                                        <span *ngIf="userRolesData=='GM'">
                                            <button class="btn-sm"
                                            *ngIf="row?.schemeType?.schemeTypeId==2 && (row.applicationStatus?.applicationStatusId==22 || row.applicationStatus?.applicationStatusId==24 )"
                                                matTooltip="Contractor"
                                                (click)="onRequestForChangeContractor(row)"
                                                type="button" class="btn   btn-warning btnaction_custome">
                                                Change contractor
                                            </button>
                                        </span>



                                        <!-- <span >
                                            <button class="btn-sm"
                                                matTooltip="Contractor"
                                                (click)="onRequestForChangeContractor(row)"
                                                type="button" class="btn   btn-warning btnaction_custome">
                                                Change contractor
                                            </button>
                                        </span> -->



                                        <!-- ************************************ -->

                                        <!-- <span>

                                            <button class=" btn-sm "
                                                *ngIf="row.natureOfWorkType?.natureOfWorkTypeId==8 && row.applicationStatus?.applicationStatusId==21"
                                                matTooltip="Contractor"
                                                (click)="onSelectContractor(row.consumerApplicationNo,row.consumerApplicationId)"
                                                type="button" class="btn   btn-warning btnaction_custome">
                                                select contractor
                                            </button>
                                        </span>

                                        <span>

                                            <button class=" btn-sm "
                                                *ngIf="row.natureOfWorkType?.natureOfWorkTypeId!=8 &&  row.applicationStatus?.applicationStatusId==21"
                                                matTooltip="Contractor"
                                                (click)="onSelectContractor(row.consumerApplicationNo,row.consumerApplicationId)"
                                                type="button" class="btn   btn-warning btnaction_custome">
                                                select contractor
                                            </button>
                                        </span> -->

                                        <!-- ************************************************ Select Contractor By Dgm(O&M) end ************************************************** -->



                                        <!-- ********************************** Application Rejection Proposal generate By Dgm(O&M) and Dgm(HTM) start ******************************* -->

                                        <span *ngIf="userRolesData=='DGM'">
                                            <button
                                                *ngIf=" (row.applicationStatus?.applicationStatusId <= 12 && row.rejectionProposal == null)"
                                                class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                (click)="applicationRejectionPerposalGenerate(row.consumerApplicationId,row.previousStage,row.consumerApplicationNo,row.schemeType.schemeTypeId)">
                                                Application-Rejection Proposal-Generate
                                            </button>
                                        </span>

                                        <span *ngIf="userRolesData=='DGM_(HTM)'">
                                            <button
                                                *ngIf=" (row.applicationStatus?.applicationStatusId <= 12 && row.rejectionProposal == null)"
                                                class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                (click)="applicationRejectionPerposalGenerate(row.consumerApplicationId,row.previousStage,row.consumerApplicationNo,row.schemeType.schemeTypeId)">
                                                Application-Rejection Proposal-Generate
                                            </button>
                                        </span>

                                        <!-- ********************************** Application Rejection Proposal generate By Dgm(O&M) and Dgm(HTM) end ******************************* -->

                                        <!-- ********************************* Rejection proposal Action Proceed by GM start ************************************************ -->
                                        <span *ngIf="userRolesData=='GM'">
                                            <button
                                                *ngIf=" ((row.applicationStatus?.applicationStatusId <= 12 || row.applicationStatus?.applicationStatusId ==37)  && row.rejectionProposal =='true')"
                                                class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                (click)="applicationRejectionPerposalHandOverToGM(row.consumerApplicationId,row.previousStage,row.consumerApplicationNo,row.schemeType.schemeTypeId)">
                                                Application-Rejection Proposal By DGM
                                            </button>
                                        </span>

                                        <!-- <span >
                                                <button
                                                
                                                    class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                    (click)="applicationRejectionPerposalHandOverToGM(row.consumerApplicationId,row.previousStage,row.consumerApplicationNo,row.schemeType.schemeTypeId)">
                                                    Application-Rejection Proposal By GM
                                                </button>
                                            </span> -->

                                        <!-- ********************************* Rejection proposal Action Proceed by GM end ************************************************ -->




                                        <!-- <span>
                                                <button matTooltip="Approve Demand" class="btn m-1 btn-sm btn-warning btnaction_custome"
                                                    (click)="applicationDemandApprove(row.consumerApplicationId,row.previousStage,row)">
                                                    Approve Demand
                                                </button>
                                            </span> -->


                                        <!-- ********************************** Demand Approve By Dgm(O&M) satrt **************************************** -->

                                        <span *ngIf="userRolesData=='DGM'">
                                            <button *ngIf=" (row.applicationStatus?.applicationStatusId == 9  )
                                            && row.isRejected != 1  && !role.DGMSTCAuthority"
                                                matTooltip="Approve Demand"
                                                class="btn m-1 btn-sm btn-warning btnaction_custome"
                                                (click)="applicationDemandApprove(row.consumerApplicationId,row.previousStage,row)">
                                                Approve Demand
                                            </button>
                                        </span>

                                        <span *ngIf="userRolesData=='GM'">
                                            <button *ngIf=" ( row.applicationStatus?.applicationStatusId == 10   )
                                            && row.isRejected != 1 && !role.DGMSTCAuthority"
                                                matTooltip="Approve Demand"
                                                class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                (click)="applicationDemandApprove(row.consumerApplicationId,row.previousStage,row)">
                                                Approve Demand
                                            </button>

                                        </span>

                                        <span *ngIf="userRolesData=='CGM'">
                                            <button *ngIf=" ( row.applicationStatus?.applicationStatusId == 11   )
                                            && row.isRejected != 1 && !role.DGMSTCAuthority"
                                                matTooltip="Approve Demand"
                                                class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                (click)="applicationDemandApprove(row.consumerApplicationId,row.previousStage,row)">
                                                Approve Demand
                                            </button>

                                        </span>

                                        <!-- ********************************** Demand Approve By Dgm(O&M) end **************************************** -->

                                        <!-- *************************************** Consumer File Download start *********************************************************** -->
                                        <span>
                                            <button matTooltip="Consumer-File-Download"
                                                class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                (click)="consumerFileDownload(row.consumerApplicationId)">

                                                Consumer-File-Download
                                            </button>

                                        </span>

                                        <!-- *************************************** Consumer File Download end *********************************************************** -->

                                        <!-- charitra start code -->




                                        <!-- DGMAuthority -->

                                        <!-- *************************************** work order generater By Dgm (O&M) start ***************************************************8 -->

                                        <!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

                                        <span *ngIf="userRolesData=='DGM'">
                                            <button
                                                *ngIf=" ((row.natureOfWorkType?.natureOfWorkTypeId==1 || row.natureOfWorkType?.natureOfWorkTypeId==6) && row.applicationStatus?.applicationStatusId == 23 && row.returnMaterialData=='True' && row.isRejected != 1  )"
                                                matTooltip="work order"
                                                class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                (click)="workOrder(row.consumerApplicationId,row.previousStage,row)">
                                                <div *ngIf="row.revisedErpNumber!=null">
                                                    Revise Work Order
                                                </div>
                                                <div *ngIf="row.revisedErpNumber==null">
                                                    Work Order
                                                </div>

                                            </button>
                                        </span>

                                        <span *ngIf="userRolesData=='DGM'">
                                            <button
                                                *ngIf=" ((row.natureOfWorkType?.natureOfWorkTypeId!=1 && row.natureOfWorkType?.natureOfWorkTypeId!=6) && row.applicationStatus?.applicationStatusId == 23 &&  row.isRejected != 1  )"
                                                matTooltip="work order"
                                                class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                (click)="workOrder(row.consumerApplicationId,row.previousStage,row)">
                                                <div *ngIf="row.revisedErpNumber!=null">
                                                    Revise Work Order
                                                </div>
                                                <div *ngIf="row.revisedErpNumber==null">
                                                    Work Order
                                                </div>

                                            </button>
                                        </span>


                                     &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&    -->

                                        <span *ngIf="userRolesData=='DGM'">
                                            <button
                                                *ngIf=" (row.applicationStatus?.applicationStatusId == 23 &&  row.isRejected != 1  )"
                                                matTooltip="work order"
                                                class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                (click)="workOrder(row.consumerApplicationId,row.previousStage,row)">
                                                <div *ngIf="row.revisedErpNumber!=null">
                                                    Revise Work Order
                                                </div>
                                                <div *ngIf="row.revisedErpNumber==null">
                                                    Work Order
                                                </div>

                                            </button>
                                        </span>







                                        <!-- 'DGM' -->

                                        <!-- <span *ngIf="userRolesData=='DGM'">
                                                <button
                                                    *ngIf=" ( row.applicationStatus?.applicationStatusId == 23 && row.isRejected != 1  )"
                                                    matTooltip="work order" class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                    (click)="workOrder(row.consumerApplicationId,row.previousStage)">
                                                    Work Order
                                                </button>
                                            </span> -->


                                        <!-- role.DGM_HTM -->


                                        <!-- &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&

                                        <span *ngIf="userRolesData=='DGM_(HTM)'">
                                            <button
                                                *ngIf=" ((row.natureOfWorkType?.natureOfWorkTypeId==1 || row.natureOfWorkType?.natureOfWorkTypeId==6) && row.applicationStatus?.applicationStatusId == 23 && row.returnMaterialData=='True'  && row.isRejected != 1 )"
                                                matTooltip="work order"
                                                class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                (click)="workOrder(row.consumerApplicationId,row.previousStage,row)">
                                                <div *ngIf="row.revisedErpNumber!=null">
                                                    Revise Work Order
                                                </div>
                                                <div *ngIf="row.revisedErpNumber==null">
                                                    Work Order
                                                </div>
                                               
                                            </button>
                                        </span>

                                        <span *ngIf="userRolesData=='DGM_(HTM)'">
                                            <button
                                                *ngIf=" ((row.natureOfWorkType?.natureOfWorkTypeId!=1 || row.natureOfWorkType?.natureOfWorkTypeId!=6) && row.applicationStatus?.applicationStatusId == 23  && row.isRejected != 1 )"
                                                matTooltip="work order"
                                                class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                (click)="workOrder(row.consumerApplicationId,row.previousStage,row)">
                                                <div *ngIf="row.revisedErpNumber!=null">
                                                    Revise Work Order
                                                </div>
                                                <div *ngIf="row.revisedErpNumber==null">
                                                    Work Order
                                                </div>
                                               
                                            </button>
                                        </span>

                                        &&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&&& -->

                                        <span *ngIf="userRolesData=='DGM_(HTM)'">
                                            <button
                                                *ngIf=" (row.applicationStatus?.applicationStatusId == 23  && row.isRejected != 1 )"
                                                matTooltip="work order"
                                                class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                (click)="workOrder(row.consumerApplicationId,row.previousStage,row)">
                                                <div *ngIf="row.revisedErpNumber!=null">
                                                    Revise Work Order
                                                </div>
                                                <div *ngIf="row.revisedErpNumber==null">
                                                    Work Order
                                                </div>

                                            </button>
                                        </span>

                                        <!-- <span *ngIf="userRolesData=='JE_IT'">
                                                <button
                                                *ngIf=" ( row.applicationStatus?.applicationStatusId == 23 && row.returnMaterialData=='True'  && row.isRejected != 1 )"
                                                    matTooltip="work order" class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                    (click)="workOrder(row.consumerApplicationId,row.previousStage,row)">
                                                    Work Order
                                                
                                                </button>
                                            </span> -->


                                        <!-- *************************************** work order generater By Dgm (O&M) end ***************************************************8 -->


                                        <!-- *************************************** Work order view start **************************************************** -->

                                        <span
                                            *ngIf="row.natureOfWorkType?.natureOfWorkTypeId!=8 && row?.schemeType?.schemeTypeId!=2">
                                            <button
                                                *ngIf=" ( row.applicationStatus?.applicationStatusId >= 24 && row.applicationStatus?.applicationStatusId!=36 && row.applicationStatus?.applicationStatusId!=38  && row.isRejected != 1 )"
                                                matTooltip="work order workOrdergGenreateSuccessfull"
                                                class="btn btn-sm btn-success btn-warning m-1 btnaction_custome"
                                                (click)="workOrdergGenreateSuccessfull(row.consumerApplicationId,row.previousStage,row)">
                                                Work Order View
                                            </button>
                                        </span>

                                        <span
                                            *ngIf="row.natureOfWorkType?.natureOfWorkTypeId==8 || (row.natureOfWorkType?.natureOfWorkTypeId!=8 && row?.schemeType?.schemeTypeId==2 )">
                                            <button
                                                *ngIf=" ( row.applicationStatus?.applicationStatusId >= 24 && row.applicationStatus?.applicationStatusId != 23 && row.applicationStatus?.applicationStatusId!=38 && row.applicationStatus?.applicationStatusId!=36 && row.isRejected != 1  )"
                                                matTooltip="work order workOrdergGenreateSuccessfull"
                                                class="btn btn-sm btn-success btn-warning m-1 btnaction_custome"
                                                (click)="workOrdergGenreateSuccessfull(row.consumerApplicationId,row.previousStage,row)">
                                                Work Order View
                                            </button>
                                        </span>

                                        <!-- *************************************** Work order view end **************************************************** -->


                                        <!-- Mis-report -->
                                        <!-- <span>
                                                <button
                                                
                                                    matTooltip="Mis-Report"
                                                    class="btn btn-sm btn-success btn-warning m-1 btnaction_custome"
                                                    (click)="MisReport()">
                                                    Mis-Report
                                                </button>
                                            </span> -->

                                        <!-- ************************************************* Work completion Request generate by Dgm (O&M) and Dgm(HTM) start *************************************8 -->

                                        <!-- DGMAuthority -->
                                        <!-- && completeDate >=row.dateOfDgmOandM -->
                                        <span *ngIf="userRolesData=='DGM'">
                                            <button *ngIf=" ( row.applicationStatus?.applicationStatusId == 25 
                                                && row.isRejected != 1 && completeDate >=row.dateOfDgmOandM ) "
                                                matTooltip="work order workOrdergGenreateSuccessfull"
                                                class="btn btn-sm m-1 btn-warning btnaction_custome"
                                                (click)="workCompletionGenreateSuccessfull(row.consumerApplicationId,row.previousStage)">
                                                Work Completion
                                            </button>
                                        </span>

                                        <!-- DGM_HTM -->
                                        <!-- && completeDate >=row.workCompletionDate -->
                                        <span *ngIf="userRolesData=='DGM_(HTM)'">
                                            <button *ngIf="(row.applicationStatus?.applicationStatusId == 25 
                                                && row.isRejected != 1 && completeDate >=row.dateOfDgmOandM )"
                                                matTooltip="work order workOrdergGenreateSuccessfull"
                                                class="btn btn-sm m-1 btn-warning btnaction_custome"
                                                (click)="workCompletionGenreateSuccessfull(row.consumerApplicationId,row.previousStage)">
                                                Work Completion
                                            </button>
                                        </span>

                                        <!-- ************************************************* Work completion Request generate by Dgm (O&M) and Dgm(HTM) end *************************************8 -->


                                        <!-- ********************************************* work completion done by Dgm(STC) start ************************************** -->

                                        <span *ngIf="userRolesData=='DGM_STC'">

                                            <button
                                                *ngIf=" ( row.applicationStatus?.applicationStatusId == 27 && row.isRejected != 1  )"
                                                matTooltip="Work Completion"
                                                class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                (click)="workCompletion(row.consumerApplicationId,row.previousStage,row)">
                                                Work Completion generate
                                            </button>
                                        </span>

                                        <!-- ********************************************* work completion done by Dgm(STC) end ************************************** -->


                                        <!-- <span >

                                                <button
                                                *ngIf=" ( row.applicationStatus?.applicationStatusId == 27 && row.isRejected != 1  )"
                                                    matTooltip="Work Completion" class="btn btn-sm btn-warning m-1 btnaction_custome"
                                                    (click)="workCompletion(row.consumerApplicationId,row.previousStage,row)">
                                                    Work Completion generate
                                                </button>
                                            </span> -->

                                        <!-- <span >
                                                <button *ngIf=" ( row.applicationStatus?.applicationStatusId == 25 
                                                    && row.isRejected != 1 && completeDate >=row.dateOfDgmOandM ) "
                                                    matTooltip="work order workOrdergGenreateSuccessfull"
                                                    class="btn btn-sm m-1 btn-warning btnaction_custome"
                                                    (click)="workCompletionGenreateSuccessfull(row.consumerApplicationId,row.previousStage)">
                                                    Work Completion
                                                </button>
                                            </span> -->



                                    </div>



                                </mat-cell>
                            </ng-container>

                            <!-- Cancel/Complete Column -->
                            <!-- <ng-container matColumnDef="action">
                                    <mat-header-cell *matHeaderCellDef [hidden]="!role.roleMatch(role.todo_module_action)"> Cancel/Complete
                                    </mat-header-cell>
                                    <mat-cell *matCellDef="let row">
                                        <ng-container *ngIf="row.status === 'Pending'">
                                            <button *appHasRole="role.todo_module_cancel" matTooltip="Cancel Todo" mat-icon-button
                                                color="warn" (click)="onCancle(row.toDoId)">
                                                <mat-icon>cancel</mat-icon>
                                            </button>
                                            <button *appHasRole="role.todo_module_complete" matTooltip="Complete Todo" mat-icon-button
                                                class="success-icon" (click)="onComplete(row.toDoId)">
                                                <mat-icon>check_circle</mat-icon>
                                            </button>
                                        </ng-container>

                                        <ng-container *ngIf="row.status === 'Complete'">
                                            <button *appHasRole="role.todo_module_not_applicable" matTooltip="Not Applicable"
                                                mat-icon-button class="not-applicable-icon">
                                                <mat-icon>not_interested</mat-icon>
                                            </button>
                                            <button *appHasRole="role.todo_module_not_applicable" matTooltip="Not Applicable"
                                                mat-icon-button class="not-applicable-icon">
                                                <mat-icon>not_interested</mat-icon>
                                            </button>
                                        </ng-container>

                                        <ng-container *ngIf="row.status === 'Cancel'">
                                            <button *appHasRole="role.todo_module_not_applicable" matTooltip="Not Applicable"
                                                mat-icon-button class="not-applicable-icon">
                                                <mat-icon>not_interested</mat-icon>
                                            </button>
                                            <button *appHasRole="role.todo_module_not_applicable" matTooltip="Not Applicable"
                                                mat-icon-button class="not-applicable-icon">
                                                <mat-icon>not_interested</mat-icon>
                                            </button>
                                        </ng-container>

                                    </mat-cell>
                                </ng-container> -->

                            <ng-container matColumnDef="loading" class="mw-5">
                                <mat-footer-cell *matFooterCellDef colspan="6">
                                    Loading data...
                                </mat-footer-cell>
                            </ng-container>

                            <ng-container matColumnDef="noData">
                                <mat-footer-cell *matFooterCellDef colspan="6">
                                    No data.
                                </mat-footer-cell>
                            </ng-container>

                            <mat-header-row *matHeaderRowDef="displayedColumns; sticky: true"></mat-header-row>
                            <mat-row *matRowDef="let row; columns: displayedColumns;"></mat-row>
                            <mat-footer-row *matFooterRowDef="['loading']"
                                [ngClass]="{'hide':listData!=null}"></mat-footer-row>
                            <mat-footer-row *matFooterRowDef="['noData']" [ngClass]="{'hide':!(listData!=null )}">
                            </mat-footer-row>
                        </mat-table>
                    </div>
                </div>


            


                <mat-paginator #paginator [length]="tableMeta?.totalItems" [pageSize]="10" [pageIndex]=0
                    [pageSizeOptions]="[10,20,30,50,100,1000,5000]" (page)="onPaginateChange($event)"
                    showFirstLastButtons>
                </mat-paginator>

            </div>
        </div>
    </div>
</div>